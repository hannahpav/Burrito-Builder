import pandas as pd
import sqlite3

df = pd.read_excel("Emissions_Totals_E_All_Data.xlsx")

# Create a connection to a new SQLite database (or connect to an existing one)
conn = sqlite3.connect('emissions_data.db')

# Write the data to a SQLite table
df.to_sql('emissions', conn, if_exists='replace', index=False)

# Create an index on columns you frequently query (adjust as needed)
c = conn.cursor()
c.execute('CREATE INDEX IF NOT EXISTS idx_country ON emissions (country)')
conn.commit()

